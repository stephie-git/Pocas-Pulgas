if (self.CavalryLogger) { CavalryLogger.start_js(["O3omT5P"]); }

__d("CometAIProductTagSuggestionsQuery.graphql",[],(function(a,b,c,d,e,f){"use strict";a=function(){var a={defaultValue:null,kind:"LocalArgument",name:"max_suggestions_per_photo"},b={defaultValue:null,kind:"LocalArgument",name:"photo_ids"},c=[{kind:"Variable",name:"max_suggestions_per_photo",variableName:"max_suggestions_per_photo"},{kind:"Variable",name:"photo_ids",variableName:"photo_ids"}],d={alias:null,args:null,kind:"ScalarField",name:"photo_id",storageKey:null},e={alias:null,args:null,kind:"ScalarField",name:"top_left",storageKey:null},f={alias:null,args:null,kind:"ScalarField",name:"bottom_right",storageKey:null},g={alias:null,args:null,kind:"ScalarField",name:"center_x",storageKey:null},h={alias:null,args:null,kind:"ScalarField",name:"center_y",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null},j={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},k={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},l={alias:null,args:[{kind:"Literal",name:"height",value:64},{kind:"Literal",name:"sizing",value:"cover-fill-cropped"},{kind:"Literal",name:"width",value:64}],concreteType:"Image",kind:"LinkedField",name:"image",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"uri",storageKey:null}],storageKey:'image(height:64,sizing:"cover-fill-cropped",width:64)'},m={alias:null,args:null,concreteType:"CurrencyAmount",kind:"LinkedField",name:"listing_price",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"formatted_amount",storageKey:null}],storageKey:null};return{fragment:{argumentDefinitions:[a,b],kind:"Fragment",metadata:null,name:"CometAIProductTagSuggestionsQuery",selections:[{alias:null,args:c,concreteType:"ProductTagAISuggestionInfo",kind:"LinkedField",name:"product_tag_suggestions",plural:!0,selections:[d,{alias:null,args:null,concreteType:"ProductTagProductBox",kind:"LinkedField",name:"suggestions",plural:!0,selections:[e,f,g,h,i,{alias:null,args:null,concreteType:"ProductTagSuggestedProduct",kind:"LinkedField",name:"products",plural:!0,selections:[{alias:null,args:null,concreteType:"ProductItem",kind:"LinkedField",name:"product_item",plural:!1,selections:[j,k,{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"primary_listing_photo",plural:!1,selections:[l],storageKey:null},m],storageKey:null},i],storageKey:null}],storageKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[b,a],kind:"Operation",name:"CometAIProductTagSuggestionsQuery",selections:[{alias:null,args:c,concreteType:"ProductTagAISuggestionInfo",kind:"LinkedField",name:"product_tag_suggestions",plural:!0,selections:[d,{alias:null,args:null,concreteType:"ProductTagProductBox",kind:"LinkedField",name:"suggestions",plural:!0,selections:[e,f,g,h,i,{alias:null,args:null,concreteType:"ProductTagSuggestedProduct",kind:"LinkedField",name:"products",plural:!0,selections:[{alias:null,args:null,concreteType:"ProductItem",kind:"LinkedField",name:"product_item",plural:!1,selections:[j,k,{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"primary_listing_photo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},l,j],storageKey:null},m],storageKey:null},i],storageKey:null}],storageKey:null}],storageKey:null}]},params:{id:"4201423586556764",metadata:{},name:"CometAIProductTagSuggestionsQuery",operationKind:"query",text:null}}}();e.exports=a}),null);
__d("CometAIProductTagSuggestionsUtil_photo.graphql",[],(function(a,b,c,d,e,f){"use strict";a={kind:"InlineDataFragment",name:"CometAIProductTagSuggestionsUtil_photo"};e.exports=a}),null);
__d("CometPhotoViewer_photo.graphql",[],(function(a,b,c,d,e,f){"use strict";a=function(){var a={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},b={kind:"Literal",name:"bool_default",value:!1},c=[a];return{argumentDefinitions:[{kind:"RootArgument",name:"scale"}],kind:"Fragment",metadata:null,name:"CometPhotoViewer_photo",selections:[a,{alias:null,args:null,kind:"ScalarField",name:"can_viewer_add_tags",storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"owner",plural:!1,selections:[a,{kind:"InlineFragment",selections:[{alias:"user_id",args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:"additional_profile_has_taggable_products",args:null,kind:"ScalarField",name:"has_taggable_products",storageKey:null}],type:"User",abstractKey:null},{kind:"InlineFragment",selections:[{alias:"page_id",args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_viewer_admin",storageKey:null},{alias:"page_shop_has_taggable_products",args:null,kind:"ScalarField",name:"has_taggable_products",storageKey:null},{kind:"InlineDataFragmentSpread",name:"FBShopsLegacyUpgradeProductTaggingUtils_page",selections:[a,{alias:null,args:null,kind:"ScalarField",name:"legacy_shop_upgrade_admin_and_page_eligibility",storageKey:null},{alias:null,args:[{kind:"Literal",name:"disable_auto_log_exposures",value:!0},{kind:"Literal",name:"qe_universe",value:"legacy_shop_admins_on_page"}],concreteType:"QECheck",kind:"LinkedField",name:"qe_check",plural:!1,selections:[{alias:"is_in_experiment",args:[b,{kind:"Literal",name:"param_name",value:"in_product_tagging_friction_experiment"}],kind:"ScalarField",name:"bool",storageKey:'bool(bool_default:false,param_name:"in_product_tagging_friction_experiment")'},{alias:"should_show_modal",args:[b,{kind:"Literal",name:"param_name",value:"show_product_tagging_friction_modal"}],kind:"ScalarField",name:"bool",storageKey:'bool(bool_default:false,param_name:"show_product_tagging_friction_modal")'}],storageKey:'qe_check(disable_auto_log_exposures:true,qe_universe:"legacy_shop_admins_on_page")'}]}],type:"Page",abstractKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"created_time",storageKey:null},{alias:null,args:[{kind:"Literal",name:"context",value:"comet_media_viewer"},{kind:"Literal",name:"height",value:1e6},{kind:"Variable",name:"scale",variableName:"scale"},{kind:"Literal",name:"width",value:1e6}],concreteType:"Image",kind:"LinkedField",name:"image",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"uri",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"width",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"height",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"accessibility_caption",storageKey:null},{args:null,kind:"FragmentSpread",name:"CometRemote360PhotoViewer_photo"},{args:null,kind:"FragmentSpread",name:"CometRemote3DPhotoViewer_photo"},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"immersive_photo_encodings",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"projection_type",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"ProductTag",kind:"LinkedField",name:"photo_product_tags",plural:!0,selections:c,storageKey:null},{kind:"InlineDataFragmentSpread",name:"CometAIProductTagSuggestionsUtil_photo",selections:[a,{alias:null,args:null,concreteType:"ProductTag",kind:"LinkedField",name:"photo_product_tags",plural:!0,selections:[a,{alias:null,args:null,concreteType:"ProductItem",kind:"LinkedField",name:"product_item",plural:!1,selections:c,storageKey:null},{alias:null,args:null,concreteType:"Vect2",kind:"LinkedField",name:"xy_location",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"x",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"y",storageKey:null}],storageKey:null}],storageKey:null}]},{alias:null,args:null,concreteType:"PhotoTagsConnection",kind:"LinkedField",name:"tags",plural:!1,selections:[{alias:null,args:null,concreteType:"PhotoTagsEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"PhotoTag",kind:"LinkedField",name:"tag",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"is_product_tag",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"Story",kind:"LinkedField",name:"container_story",plural:!1,selections:[a,{alias:null,args:null,kind:"ScalarField",name:"post_id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"encrypted_tracking",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"viewability_config",storageKey:null},{alias:null,args:null,concreteType:"CometClientViewConfig",kind:"LinkedField",name:"client_view_config",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"can_delay_log_impression",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"use_banzai_signal_imp",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"use_banzai_vital_imp",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:[{kind:"Literal",name:"framework",value:"WARNING_SCREENS"},{kind:"Literal",name:"location",value:"photo_viewer"}],concreteType:"CIXScreen",kind:"LinkedField",name:"cix_screen",plural:!1,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"view_model",plural:!1,selections:[{kind:"InlineFragment",selections:[{documentName:"CometPhotoViewer_photo",fragmentName:"CometWarningScreenOverlay_data",fragmentPropName:"data",kind:"ModuleImport"}],type:"OverlayWarningScreenViewModel",abstractKey:null}],storageKey:null}],storageKey:'cix_screen(framework:"WARNING_SCREENS",location:"photo_viewer")'}],type:"Photo",abstractKey:null}}();e.exports=a}),null);
__d("CometAIProductTagSuggestionsQuery.react",["CometAIProductTagSuggestionsQuery.graphql"],(function(a,b,c,d,e,f,g){"use strict";var h;a=h!==void 0?h:h=b("CometAIProductTagSuggestionsQuery.graphql");g["default"]=a}),98);
__d("SharedAIProductTagUtils",[],(function(a,b,c,d,e,f){"use strict";c=35;var g=90,h=.35,i=5;function a(a){var b=new Map();a.product_tag_suggestions.map(function(a){var c=a.photo_id;a=a.suggestions;if(c==null||a==null)return;var d=[],e=[];a.map(function(a){a=(a=a)!=null?a:{};var b=a.bottom_right,c=a.center_x,f=a.center_y,i=a.products,j=a.score;a=a.top_left;if(c==null||f==null||j==null)return;c=c*100;f=f*100;i=i==null?void 0:i[0];var k=i==null?void 0:i.score;i=(i=i==null?void 0:i.product_item)!=null?i:{};var l=i.id,m=i.listing_price,n=i.name;i=i.primary_listing_photo;b={boundingBoxJSON:JSON.stringify({bottomRight:b,topLeft:a}),boxScore:j,productID:l,productScore:k};if(k!=null&&k<g&&d.length===0){if(l==null||n==null)return null;k={id:l,image_uri:i==null?void 0:(a=i.image)==null?void 0:a.uri,metadata:{product_tag_type:"AI_HIGH_CONFIDENCE"},name:n,product_price:m==null?void 0:m.formatted_amount};l=babelHelpers["extends"]({},b,{source:"AI_suggested",taggee:k,x:c,y:f});d.push(l)}else j>h&&e.push(babelHelpers["extends"]({},b,{x:c,y:f}))});b.set(c,{knownSuggestions:d,unknownSuggestions:e})});return b}function b(a,b,c,d){return a>=c-i&&a<=c+i&&b>=d-i&&b<=d+i}f.PRETAGGING_PRODUCT_THRESHOLD=c;f.PRODUCT_SCORE_THRESHOLD=g;f.BOX_SCORE_THRESHOLD=h;f.USER_TAGGING_TOLERANCE=i;f.processAIProductTagSuggestionsQueryResponse=a;f.isPointNearbyPoint=b}),66);
__d("CometAIProductTagSuggestionsUtil.react",["CometAIProductTagSuggestionsUtil_photo.graphql","CometRelay","SharedAIProductTagUtils"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h!==void 0?h:h=b("CometAIProductTagSuggestionsUtil_photo.graphql");function j(a,b){return a.productID===b.productID||d("SharedAIProductTagUtils").isPointNearbyPoint(a.x,a.y,b.x,b.y)}function k(a){return(a=a==null?void 0:(a=a.photo_product_tags)==null?void 0:a.map(function(a){var b;b=(b=a.product_item)==null?void 0:b.id;a=a.xy_location;var c=a==null?void 0:a.x;a=a==null?void 0:a.y;return c===void 0||c===null||a===void 0||a===null||b===null||b===void 0?null:{productID:b,x:c,y:a}}).filter(Boolean))!=null?a:[]}function a(a,b){a=d("CometRelay").readInlineData(i,a);b=b==null?void 0:b.get((b=a==null?void 0:a.id)!=null?b:"");var c=k(a);if(!b)return[];a=b==null?void 0:b.filter(function(a){var b=(c==null?void 0:c.filter(function(b){return j({productID:a.productID,x:a.x,y:a.y},b)}).length)>0;return!b});return a}function c(a,b){a=d("CometRelay").readInlineData(i,a);b=b==null?void 0:b.get((b=a==null?void 0:a.id)!=null?b:"");var c=k(a);if(!b)return[];a=b==null?void 0:b.filter(function(a){var b=(c==null?void 0:c.filter(function(b){return j({productID:a.productID,x:a.x,y:a.y},b)}).length)>0;return!b});return a}function e(a){return!a}g.getUntaggedKnownTags=a;g.getUntaggedUnknownTags=c;g.canUsePretagExperience=e}),98);
__d("HoveredProductIDContext",["emptyFunction","react"],(function(a,b,c,d,e,f,g){"use strict";a=d("react");b=a.createContext({hoveredProductID:null,setHoveredProductID:c("emptyFunction")});g["default"]=b}),98);
__d("CometFeedStoryDropdownMenuLoggerContext",["react"],(function(a,b,c,d,e,f,g){"use strict";a=d("react");b=a.createContext({nodeID:null});g["default"]=b}),98);
__d("CometPhotoTaggingConstants",[],(function(a,b,c,d,e,f){"use strict";a=3;b=1;c=94;f.BOX_BORDER_SIZE=a;f.INITIAL_PHOTO_RENDER_SCALE=b;f.TAGGING_BOX_SIZE=c}),66);
__d("CometPhotoViewerZoomUtils",[],(function(a,b,c,d,e,f){"use strict";function a(a,b,c){return c[0]===0||c[1]===0?!1:c[1]<a.clientHeight*b||c[0]<a.clientWidth*b}f.isOverflown=a}),66);
__d("CometPhotoViewerImgRenderer.react",["CometHeroHoldTrigger.react","CometImage.react","react","useStable"],(function(a,b,c,d,e,f,g){"use strict";var h=d("react");b=d("react");var i=b.useLayoutEffect,j=b.useState,k={img:{objectFit:"r0294ipz"}};function l(a){var b=a.alt,d=a.currentImgSrc,e=a.height,f=a.origSrc,g=a.xstyle;a=babelHelpers.objectWithoutPropertiesLoose(a,["alt","currentImgSrc","height","origSrc","xstyle"]);var l=c("useStable")(function(){var a=new Image();a.src=d;return a}),m=j(l.complete),n=m[0],o=m[1];m=j(!1);var p=m[0],q=m[1];i(function(){if(l.complete)o(!0);else{l.onload=function(){o(!0)};l.onerror=function(){q(!0)};return function(){l.onload=null,l.onerror=null}}},[l,o,q]);return h.jsxs(h.Fragment,{children:[h.jsx(c("CometHeroHoldTrigger.react"),{description:"Progressive Image",hold:!n&&!p&&f!=null}),h.jsx(c("CometImage.react"),babelHelpers["extends"]({},a,{alt:b,height:n||f==null?void 0:e,src:n||f==null?d:f,testid:void 0,xstyle:[g,k.img]}))]})}function a(a){return h.jsx(l,babelHelpers["extends"]({},a),a.currentImgSrc)}g["default"]=a}),98);
__d("CometPhotoViewerZoom.react",["CometMediaViewerDispatcherContext","CometMediaViewerViewStateContext","CometPhotoViewerContainerContext","CometPhotoViewerZoomUtils","react"],(function(a,b,c,d,e,f,g){"use strict";var h=d("react");b=d("react");var i=b.useCallback,j=b.useContext,k=b.useRef;function a(a){a=a.children;var b=j(c("CometMediaViewerViewStateContext")),e=j(c("CometMediaViewerDispatcherContext")),f=j(c("CometPhotoViewerContainerContext")),g=k(null),l=i(function(){if(f!=null&&f.current!=null){var a=f.current.getBoundingClientRect();return{height:a.height,left:a.left,top:a.top,width:a.width}}return null},[f]),m=i(function(a){var b;b=(b=g.current)==null?void 0:b.getBoundingClientRect();var c=l();b&&c&&e({clientX:a.clientX,clientY:a.clientY,currentRectCoord:[b.top,b.left],currentRectSize:[b.width,b.height],height:c.height,type:"DRAG",width:c.width})},[e,l]),n=i(function(){window.removeEventListener("mouseup",n),window.removeEventListener("mousemove",m)},[m]),o=i(function(a){if(b.scale<=1)return;var c=l();if(g&&g.current&&c&&!d("CometPhotoViewerZoomUtils").isOverflown(g.current,b.scale,[c.width,c.height]))return;a.preventDefault();e({clientX:a.clientX,clientY:a.clientY,type:"DRAG_START"});window.addEventListener("mouseup",n);window.addEventListener("mousemove",m)},[e,l,m,n,b.scale]);return h.jsx("div",{onMouseDown:o,children:h.jsx("div",{className:b.prevScale!==b.scale?"heur4gxb flx89l3n tn0ko95a":"",ref:g,style:{transform:"translate("+b.translateX+"px, "+b.translateY+"px) scale("+b.scale+")"},children:a})})}g["default"]=a}),98);
__d("CometPhotoViewerResponsiveInnerWrapper.react",["CometPhotoViewerZoom.react","CometRouteRenderType","gkx","react","stylex"],(function(a,b,c,d,e,f,g){"use strict";var h=d("react"),i={backgroundContainerDialog:{"@media (max-width: 899px)":{height:"nos9j3a5"}},backgroundContainerDialogWithFooter:{height:"n626y76b","@media (max-width: 899px)":{height:"aessy0lw"}},backgroundContainerResponsive:{alignItems:"bp9cbjyn",display:"j83agx80",position:"l9j0dhe7","@media (max-width: 899px)":{height:"spskuzq3"}},backgroundContainerTabs:{height:"bkyfam09","@media (max-width: 899px)":{height:"pw8zj2ei"}},backgroundContainerTabsWithFooter:{height:"bekozo2m","@media (max-width: 899px)":{height:"f6tgzqhp"}},ie11PhotoWrapperWidth:{width:"k4urcfbm"},ie11minHeight:{minHeight:"kltspiyx"},image:{maxWidth:"d2edcug0","@media (max-width: 899px)":{maxHeight:"r9f5tntg"}},maxImageHeightDialog:{maxHeight:"ji94ytn4","@media (max-width: 899px)":{maxHeight:"bnxxjg7g"}},maxImageHeightDialogWithFooter:{maxHeight:"nskh8ow2","@media (max-width: 899px)":{maxHeight:"dx5evmzu"}},maxImageHeightTabs:{maxHeight:"gitj76qy","@media (max-width: 899px)":{maxHeight:"bnxxjg7g"}},maxImageHeightTabsWithFooter:{maxHeight:"kgqd366c","@media (max-width: 899px)":{maxHeight:"a7lra598"}},passthroughImage:{backgroundPosition:"d2hbt3d9",backgroundRepeat:"qb00l2mb",backgroundSize:"gj6al65z",height:"datstx6m",width:"k4urcfbm"},photoWrapperPlaceholder:{height:"datstx6m",width:"k4urcfbm"},photoWrapperResponsive:{alignItems:"bp9cbjyn",display:"j83agx80",flexDirection:"cbu4d94t",justifyContent:"taijpn5t",position:"l9j0dhe7"},placeholderContainer:{height:"datstx6m",width:"k4urcfbm"}};function j(a,b){a===void 0&&(a=!1);b===void 0&&(b=!1);var e=d("CometRouteRenderType").useIsPushView();return c("stylex")(i.backgroundContainerResponsive,!a&&e&&i.backgroundContainerDialog,!a&&!e&&i.backgroundContainerTabs,a&&e&&i.backgroundContainerDialogWithFooter,a&&!e&&i.backgroundContainerTabsWithFooter,b&&i.placeholderContainer)}function k(a,b){var e=d("CometRouteRenderType").useIsPushView();return c("stylex")(!a&&e&&i.maxImageHeightDialog,!a&&!e&&i.maxImageHeightTabs,a&&e&&i.maxImageHeightDialogWithFooter,a&&!e&&i.maxImageHeightTabsWithFooter,b&&i.passthroughImage,!b&&i.image,c("gkx")("1299319")&&i.ie11minHeight)}function l(a,b){var e=d("CometRouteRenderType").useIsPushView();return[!a&&e&&i.maxImageHeightDialog,!a&&!e&&i.maxImageHeightTabs,a&&e&&i.maxImageHeightDialogWithFooter,a&&!e&&i.maxImageHeightTabsWithFooter,b&&i.passthroughImage,!b&&i.image,c("gkx")("1299319")&&i.ie11minHeight]}function a(a,b){var d=a.height,e=a.imageUri,f=a.showPlaceholderImage;f=f===void 0?!0:f;var g=a.width;a=a.withFooter;a=a===void 0?!1:a;a=k(a,!0);var l=j(!1,!0);return h.jsx("div",{className:l,ref:(l=b)!=null?l:null,children:e!=null&&f&&h.jsx("div",{className:c("stylex")(i.photoWrapperResponsive,i.photoWrapperPlaceholder),children:h.jsx("div",{className:a,style:d!=null&&g!=null?{backgroundImage:"url("+e+")",maxHeight:d,maxWidth:g}:{backgroundImage:"url("+e+")"}},e)})})}function b(a,b){var d=a.imageComponent,e=a.imageComponentWithXStyle;a=a.withFooter;a=a===void 0?!1:a;var f=k(a,!1);a=l(a,!1);b=h.jsx("div",{className:c("stylex")(i.photoWrapperResponsive,c("gkx")("1299319")&&i.ie11PhotoWrapperWidth),ref:b,children:d!=null?d(f):e!=null?e(a):null});return h.jsx(c("CometPhotoViewerZoom.react"),{children:b})}e=h.forwardRef(b);f=h.forwardRef(a);g.useCometPhotoViewerContainerStyles=j;g.CometPhotoViewerImageWrapper=e;g.CometPhotoViewerPlaceholderWrapper=f}),98);
__d("CometPhotoViewerViewStateContext",["react"],(function(a,b,c,d,e,f,g){"use strict";a=d("react");b=a.createContext({highlightedKnownAITagID:null,isProductTagging:!1,knownAITags:null,tagModeEnabled:!1,unknownAITags:null});g["default"]=b}),98);
__d("CometPhotoViewerViewStateDispatcherContext",["emptyFunction","react"],(function(a,b,c,d,e,f,g){"use strict";a=d("react");b=a.createContext(c("emptyFunction"));g["default"]=b}),98);
__d("NumAiSuggestionsBubbleImpressionFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f){"use strict";a=b("getFalcoLogPolicy_DO_NOT_USE")("1746400");c=b("FalcoLoggerInternal").create("num_ai_suggestions_bubble_impression",a);e.exports=c}),null);
__d("ProductTagPhotoViewerDoneClickFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f){"use strict";a=b("getFalcoLogPolicy_DO_NOT_USE")("1744225");c=b("FalcoLoggerInternal").create("product_tag_photo_viewer_done_click",a);e.exports=c}),null);
__d("CometPhotoViewer.react",["fbt","Actor","CometAIProductTagSuggestionsUtil.react","CometHero.react","CometImage.react","CometMediaViewerStage.react","CometPagelet.react","CometPhotoTaggingConstants","CometPhotoViewerContainerContext","CometPhotoViewerImgRenderer.react","CometPhotoViewerResponsiveInnerWrapper.react","CometPhotoViewerViewStateContext","CometPhotoViewerViewStateDispatcherContext","CometPhotoViewer_photo.graphql","CometPlaceholder.react","CometRelay","CometRouteParams","CometRouteRenderType","CometTheme.react","CometVisualCompletionAttributes","CometWarningScreenContext","FBShopsLegacyUpgradeProductTaggingUtils","JSResourceForInteraction","NumAiSuggestionsBubbleImpressionFalcoEvent","ProductTagPhotoViewerDoneClickFalcoEvent","TetraButton.react","TetraText.react","WebSession","cr:1685690","cr:1685691","deferredLoadComponent","gkx","react","recoverableViolation","requireDeferred","requireDeferredForDisplay","stylex","useCometLazyDialog","useCurrentRoute","useMediaViewerVPVDLogger","useMergeRefs","useRoutePassthroughProps","useStoryViewabilityLogger"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=d("react");e=d("react");var k=e.useCallback,l=e.useContext,m=e.useEffect,n=e.useMemo,o=e.useRef,aa=c("requireDeferred")("CometMediaTagFalcoEvent").__setRef("CometPhotoViewer.react");f=c("requireDeferred")("CometPhotoTagLayer.react").__setRef("CometPhotoViewer.react");e=c("requireDeferredForDisplay")("CometPhotoViewerTopRightIcons.react").__setRef("CometPhotoViewer.react");var ba=c("deferredLoadComponent")(f),ca=c("deferredLoadComponent")(e),da=c("JSResourceForInteraction")("CometPhotoViewerProductTagEducationDialog.react").__setRef("CometPhotoViewer.react"),p={container:{display:"j83agx80",flexDirection:"cbu4d94t",flexGrow:"buofh1pr",position:"l9j0dhe7"},noPointerEvents:{pointerEvents:"hzruof5a"},peopleTagInstructionText:{paddingBottom:"ihqw7lf3"},productTagInstructions:{alignItems:"bp9cbjyn",display:"j83agx80",flexDirection:"btwxx1t3"},tagDoneDiv:{pointerEvents:"oqq733wu"},tagInstruction:{position:"pmk7jnqg",start:"kfkz5moi",transform:"cj5g2342"},tagInstructionRow:{alignItems:"aovydwv3",backgroundImage:"kpb67iw4",bottom:"i09qtzwb",display:"j83agx80",height:"fdipuqhw",justifyContent:"taijpn5t",paddingBottom:"jfpizvyy",pointerEvents:"hzruof5a",position:"pmk7jnqg",width:"k4urcfbm"},tagInstructionText:{alignItems:"bp9cbjyn",display:"j83agx80",paddingEnd:"rv4hoivh"},tagLayer:{bottom:"i09qtzwb",end:"n7fi1qx3",position:"pmk7jnqg",start:"j9ispegn",top:"kr520xx4"}};function ea(a){return(a||[]).some(function(a){a=a.projection_type;return a==="tiled_cubemap"})}function fa(a){return(a||[]).some(function(a){a=a.projection_type;return a==="three_d"})}var ga=i!==void 0?i:i=b("CometPhotoViewer_photo.graphql");function a(a){var e,f,g,i,q,r,s,t,u=l(c("CometPhotoViewerViewStateDispatcherContext")),v=l(c("CometPhotoViewerViewStateContext")),w=c("useCometLazyDialog")(da),ha=w[0];w=o(null);var x=d("Actor").useActor(),y=x[0];x[1];x=a.origHeight;var z=a.origSrc,A=a.origWidth,B=a.photo,C=a.photoTagLayerQueryReference,D=a.showTag;D=D===void 0?!1:D;var ia=a.storyRenderLocation,ja=babelHelpers.objectWithoutPropertiesLoose(a,["origHeight","origSrc","origWidth","photo","photoTagLayerQueryReference","showTag","storyRenderLocation"]),E=d("CometRelay").useFragment(ga,B);B=k(function(){u({tagData:{isProductTagging:!1,tagModeEnabled:!1},type:"UPDATE_TAG_DATA"})},[u]);var F=E==null?void 0:(e=E.image)==null?void 0:e.uri,G=E==null?void 0:E.accessibility_caption,H=E==null?void 0:E.id,I=E==null?void 0:(e=E.owner)==null?void 0:e.id;e=(e=E==null?void 0:(e=E.tags)==null?void 0:e.edges)!=null?e:[];var J=o(new Set(e.map(function(a){return a==null?void 0:(a=a.node)==null?void 0:a.name}))),K=E==null?void 0:E.created_time,L=E==null?void 0:(e=E.container_story)==null?void 0:e.post_id;e=(E==null?void 0:E.can_viewer_add_tags)===!0;f=E==null?void 0:(f=E.cix_screen)==null?void 0:f.view_model;var M=n(function(){return{authorId:I,createdTime:K,fbid:H,source:6,storyContainerId:L}},[I,K,H,L]);M=c("useMediaViewerVPVDLogger")(M);var N=M[0],O=M[1];M=E==null?void 0:(M=E.container_story)==null?void 0:M.encrypted_tracking;g=E==null?void 0:(g=E.container_story)==null?void 0:g.viewability_config;i=(i=E==null?void 0:E.container_story)!=null?i:{};i=i.client_view_config;i={can_delay_log_impression:i==null?void 0:i.can_delay_log_impression,use_banzai_signal_imp:i==null?void 0:i.use_banzai_signal_imp,use_banzai_vital_imp:i==null?void 0:i.use_banzai_vital_imp};i=c("useStoryViewabilityLogger")({clientViewConfig:i,disabledViewabilityEventTypes:[5],encryptedTracking:M,position:0,viewabilityConfig:g});M=i.ref;g=c("useMergeRefs")(N,M);i=d("CometPhotoViewerResponsiveInnerWrapper.react").useCometPhotoViewerContainerStyles();var P=d("CometWarningScreenContext").useIsOverlayShown();N=d("CometAIProductTagSuggestionsUtil.react").getUntaggedKnownTags(E,v.knownAITags);M=d("CometAIProductTagSuggestionsUtil.react").getUntaggedUnknownTags(E,v.unknownAITags);var Q=N.length+M.length,R=o(function(){b("NumAiSuggestionsBubbleImpressionFalcoEvent").log(function(){var a;return{creator_id:E==null?void 0:(a=E.owner)==null?void 0:a.page_id,media_id:H,media_type:"photo",platform:"comet",referral_source:"post_viewer"}})});m(function(){Q>0&&(R.current&&R.current())},[Q]);N=function(){var a;u({tagData:{isProductTagging:!1,tagModeEnabled:!1},type:"UPDATE_TAG_DATA"});if(H==null){c("recoverableViolation")("photo id can not be null","comet_feed");return}a=(a=E==null?void 0:(a=E.tags)==null?void 0:a.edges)!=null?a:[];a=a.map(function(a){return a==null?void 0:(a=a.node)==null?void 0:a.name});var e=d("WebSession").getId(),f=J.current.size?a.filter(function(a){return!J.current.has(a)}):a;S?b("ProductTagPhotoViewerDoneClickFalcoEvent").log(function(){return{container_post_id:L,creator_id:y,media_id:H,media_type:"photo",platform:"comet",referral_source:"post_viewer"}}):aa.onReady(function(a){a.log(function(){return{media_fbid:H,num_users_tagged:f.length,session_id:e}})});J.current=new Set(a)};M=Boolean(E==null?void 0:(M=E.tags)==null?void 0:M.edges.some(function(a){return!(a==null?void 0:(a=a.tag)==null?void 0:a.is_product_tag)}));q=((E==null?void 0:(q=E.photo_product_tags)==null?void 0:q.length)||0)>0;r=Boolean(E==null?void 0:(r=E.owner)==null?void 0:r.page_shop_has_taggable_products)&&Boolean(E==null?void 0:(r=E.owner)==null?void 0:r.is_viewer_admin);s=E==null?void 0:(s=E.owner)==null?void 0:s.additional_profile_has_taggable_products;s=s!==null&&s!==void 0?Boolean(s)&&y===(E==null?void 0:(s=E.owner)==null?void 0:s.user_id):r&&Boolean((E==null?void 0:(s=E.owner)==null?void 0:s.page_id)!=null)&&y===(E==null?void 0:(s=E.owner)==null?void 0:s.page_id);q=M||!q&&!M&&!r;var S=s&&!M;s=(E==null?void 0:E.owner)&&(E==null?void 0:(r=E.owner)==null?void 0:r.page_id)!=null?d("FBShopsLegacyUpgradeProductTaggingUtils").getProductTaggingLegacyUpgradeStatus(E==null?void 0:E.owner):null;M=d("CometRouteParams").useRouteParams();r=c("useCurrentRoute")();r=(r=r==null?void 0:r.transparent)!=null?r:!1;var T=M.aymt_channel!==null&&M.aymt_channel!==void 0,U=o(!1);m(function(){T&&(U.current||ha({})),U.current=!0});M=d("CometRouteRenderType").useIsPushView();var V=d("CometWarningScreenContext").useParentRenderInstructions(),W=E==null?void 0:(t=E.image)==null?void 0:t.width,X=E==null?void 0:(t=E.image)==null?void 0:t.height;t=c("useRoutePassthroughProps")();var Y=(t==null?void 0:t.glbFileURI)!=null?String(t==null?void 0:t.glbFileURI):null;t=n(function(){var a;if(E==null||F==null||W==null||X==null)return null;a=j.jsx(c("CometImage.react"),{alt:(a=G)!=null?a:void 0,height:X,src:F,width:W},F);if(b("cr:1685691")!=null&&c("gkx")("1848344")&&Y!=null)return j.jsx(b("cr:1685691"),{fallback:a,glbFileURI:String(Y),photo:E});else if(b("cr:1685690")!=null&&c("gkx")("1680758")&&ea(E==null?void 0:E.immersive_photo_encodings))return j.jsx(b("cr:1685690"),{fallback:a,headingIndicationLocationTop:!0,photo:E});else if(b("cr:1685691")!=null&&c("gkx")("1680759")&&fa(E==null?void 0:E.immersive_photo_encodings))return j.jsx(b("cr:1685691"),{fallback:a,photo:E})},[F,X,E,W,Y]);if(F==null){c("recoverableViolation")("Error loading media. More investigation is needed, might be an invalid photo, a special type of MediaSet, or something else.","comet_ui");return h._("No hay ninguna foto v\u00e1lida para mostrar.")}var Z=V==="CLIP_TO_MEDIA",$=f!=null?j.jsx(d("CometRelay").MatchContainer,{match:f,props:{alwaysShowDetails:!0,data:f,isFullScreenMediaPlayerStyle:!0,mediaUri:F,surface:"photo_viewer"}}):null,ka=(V=x)!=null?V:X,la=D&&C!=null?j.jsx(c("CometPlaceholder.react"),{fallback:null,children:j.jsx("div",babelHelpers["extends"]({},c("CometVisualCompletionAttributes").IGNORE,{className:c("stylex")(p.tagLayer,!v.tagModeEnabled&&p.noPointerEvents),children:j.jsx(ba,{isTaggingProducts:v.isProductTagging,photoTagLayerQueryReference:C,tagBoxSize:d("CometPhotoTaggingConstants").TAGGING_BOX_SIZE,tagModeEnabled:v.tagModeEnabled})}))}):null,ma=c("CometVisualCompletionAttributes").MEDIA_VC_IMAGE;f=j.jsx(d("CometPhotoViewerResponsiveInnerWrapper.react").CometPhotoViewerImageWrapper,{imageComponentWithXStyle:function(a){var b;return j.jsxs(j.Fragment,{children:[O,j.jsx(c("CometHero.react"),{description:"MainPhoto"}),j.jsx(c("CometPhotoViewerImgRenderer.react"),babelHelpers["extends"]({},ma,{alt:(b=G)!=null?b:void 0,currentImgSrc:F,height:(b=ka)!=null?b:void 0,origSrc:z,xstyle:a})),Z&&$,la]})}});V=j.jsx(d("CometPagelet.react").Placeholder,{className:i,fallback:z!=null?j.jsx(d("CometPhotoViewerResponsiveInnerWrapper.react").CometPhotoViewerPlaceholderWrapper,{height:x,imageUri:z,ref:g,showPlaceholderImage:z!=null&&A!=null&&x!=null&&!P,width:A}):j.jsx("div",{className:i,ref:g,children:j.jsx(d("CometPhotoViewerResponsiveInnerWrapper.react").CometPhotoViewerImageWrapper,{imageComponentWithXStyle:function(a){var b;return j.jsxs(j.Fragment,{children:[O,!P&&j.jsx(c("CometImage.react"),{alt:(b=G)!=null?b:void 0,src:F,testid:void 0,xstyle:a},F)]})}})}),name:"MediaViewerPhoto",pageletType:"media",ref:g,children:t!=null?t:f},F);x=v.isProductTagging?c("stylex")(p.productTagInstructions):c("stylex")(p.tagInstruction);A=v.isProductTagging?h._("Haz clic en la foto para empezar a etiquetar productos"):h._("Haz clic en la foto para etiquetarla");i=D&&C!=null&&e===!0&&!t;return j.jsx("div",{className:c("stylex")(p.container),"data-testid":void 0,ref:w,children:j.jsxs(c("CometPhotoViewerContainerContext").Provider,{value:w,children:[j.jsx(c("CometMediaViewerStage.react"),babelHelpers["extends"]({backgroundColor:r&&M?"dark":"default",initialTracePolicy:a.initialTracePolicy,onNavigatePhoto:B,storyRenderLocation:ia,subOrigin:a.subOrigin},ja,{children:V})),P?null:j.jsx(ca,{authorId:I,canTag:i,fromAYMTRetroTagNotification:T,numNewAISuggestions:Q,photoID:H,shouldShowPeopleTagButton:q,shouldShowProductTagButton:S,storyContainerId:L,upgradeShopModalInfo:s}),i&&v.tagModeEnabled?j.jsx(c("CometTheme.react"),{theme:"dark",xstyle:p.tagInstructionRow,children:j.jsxs("div",{className:x,children:[j.jsx("div",{className:c("stylex")(p.tagInstructionText),children:j.jsx("div",{className:S!==!0?c("stylex")(p.peopleTagInstructionText):null,children:j.jsx(c("TetraText.react"),{color:"primary",numberOfLines:1,type:"headline4",children:A})})}),j.jsx("div",{className:c("stylex")(p.tagDoneDiv),children:j.jsx(c("TetraButton.react"),{label:h._("Finalizar etiquetado"),onPress:N,type:"primary"})})]})}):null,!Z&&$]})})}g["default"]=a}),98);
__d("ProductTaggingAiEvaluationFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f){"use strict";a=b("getFalcoLogPolicy_DO_NOT_USE")("1744233");c=b("FalcoLoggerInternal").create("product_tagging_ai_evaluation",a);e.exports=c}),null);